# å¦‚ä½•ç®€åŒ– main.c

## ğŸ“‹ æ­¥éª¤

### 1. åœ¨main.cå¼€å¤´æ·»åŠ æ–°æ¨¡å—çš„å¤´æ–‡ä»¶

```c
/* åœ¨ç°æœ‰çš„includeä¹‹åæ·»åŠ  */
#include "signal_processing.h"
#include "adc_handler.h"
#include "measurement.h"
```

### 2. åˆ é™¤main.cä¸­çš„é‡å¤å‡½æ•°å®šä¹‰

éœ€è¦åˆ é™¤ä»¥ä¸‹å‡½æ•°ï¼ˆå®ƒä»¬å·²ç»åœ¨æ–°æ¨¡å—ä¸­ï¼‰ï¼š

#### ä» signal_processing.c ç§»é™¤çš„å‡½æ•°ï¼š
```c
åˆ é™¤è¿™äº›å‡½æ•°å®šä¹‰ï¼š
- CalculatePeakToPeak()         (line 230-245)
- CalculateDCOffset()           (line 253-266)
- CalculateDistortion()         (line 277-327)
- CalculateAmplitude_DFT()      (line 352-383)
- EstimatePhaseShift_Int()      (line 399-452)
```

#### ä» adc_handler.c ç§»é™¤çš„å‡½æ•°ï¼š
```c
åˆ é™¤è¿™äº›å‡½æ•°å®šä¹‰ï¼š
- ExtractADCData()              (line 204-222)
- ProcessADCData()              (line 458-617)
```

#### ä» measurement.c ç§»é™¤çš„å‡½æ•°ï¼š
```c
åˆ é™¤è¿™äº›å‡½æ•°å®šä¹‰ï¼š
- AutoSweep()                   (line 625-913)
- AutoCalibration()             (line 921-1020)
```

### 3. ä¿®æ”¹å…¨å±€å˜é‡

å°†æ ¡å‡†æ•°æ®çš„å®šä¹‰æ”¹ä¸ºå¤–éƒ¨å£°æ˜ï¼š

```c
/* åˆ é™¤ */
// static CalibrationData_t g_calibration = {0};

/* æ·»åŠ  */
extern CalibrationData_t g_calibration;  /* åœ¨measurement.cä¸­å®šä¹‰ */
```

### 4. ä¿ç•™main.cä¸­çš„å†…å®¹

**ä¿ç•™è¿™äº›éƒ¨åˆ†**ï¼š
- æ‰€æœ‰includeè¯­å¥
- #defineå¸¸é‡å®šä¹‰
- externå£°æ˜ï¼ˆDDSå‡½æ•°ã€adc_bufferç­‰ï¼‰
- SignalType_tæšä¸¾å’Œg_signal_typeå˜é‡
- main()å‡½æ•°
- ä¸²å£å‘½ä»¤è§£æéƒ¨åˆ†
- delay_ms()å’Œdelay_us()å‡½æ•°
- å…¶ä»–åˆå§‹åŒ–ä»£ç 

### 5. åœ¨Keilå·¥ç¨‹ä¸­æ·»åŠ æ–°æ–‡ä»¶

æ‰“å¼€Keil MDKï¼Œåœ¨Projectçª—å£ä¸­ï¼š
1. å³é”®ç‚¹å‡» `Source Group 1` æˆ– `USER`ç»„
2. é€‰æ‹© `Add Files to Group...`
3. æ·»åŠ ä»¥ä¸‹æ–‡ä»¶ï¼š
   - `signal_processing.c`
   - `adc_handler.c`
   - `measurement.c`

### 6. ç¼–è¯‘æµ‹è¯•

1. ç‚¹å‡» **Build (F7)**
2. æ£€æŸ¥æ˜¯å¦æœ‰ç¼–è¯‘é”™è¯¯
3. å¸¸è§é—®é¢˜ï¼š
   - å¦‚æœæç¤ºæ‰¾ä¸åˆ°å‡½æ•°ï¼Œæ£€æŸ¥æ˜¯å¦æ·»åŠ äº†å¯¹åº”çš„å¤´æ–‡ä»¶
   - å¦‚æœæç¤ºé‡å¤å®šä¹‰ï¼Œæ£€æŸ¥main.cä¸­æ˜¯å¦è¿˜ä¿ç•™äº†æ—§å‡½æ•°

## ğŸ“Š ç®€åŒ–å‰åå¯¹æ¯”

### ç®€åŒ–å‰ï¼ˆmain.cçº¦1053è¡Œï¼‰
```
main.c:
  - åˆå§‹åŒ–ä»£ç 
  - æ‰€æœ‰ä¿¡å·å¤„ç†å‡½æ•°  â† 500+è¡Œ
  - æ‰€æœ‰ADCå¤„ç†å‡½æ•°    â† 200+è¡Œ
  - æ‰€æœ‰æµ‹é‡å‡½æ•°       â† 300+è¡Œ
  - mainå‡½æ•°å’Œå‘½ä»¤è§£æ
```

### ç®€åŒ–åï¼ˆmain.cçº¦250è¡Œï¼‰
```
main.c:
  - åˆå§‹åŒ–ä»£ç 
  - mainå‡½æ•°å’Œå‘½ä»¤è§£æ
  - å»¶æ—¶å‡½æ•°

signal_processing.c: ä¿¡å·å¤„ç†ï¼ˆ200è¡Œï¼‰
adc_handler.c: ADCå¤„ç†ï¼ˆ200è¡Œï¼‰
measurement.c: æµ‹é‡åŠŸèƒ½ï¼ˆ400è¡Œï¼‰
```

## âœ… å®Œæˆæ ‡å¿—

ç¼–è¯‘é€šè¿‡ä¸”æ— è­¦å‘Šï¼Œè¯´æ˜é‡æ„æˆåŠŸï¼

## ğŸ¯ ä¼˜åŠ¿

1. **main.cæ›´ç®€æ´**ï¼šä»1000+è¡Œå‡å°‘åˆ°250è¡Œ
2. **æ¨¡å—åŒ–è®¾è®¡**ï¼šèŒè´£æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤
3. **ä»£ç å¤ç”¨**ï¼šä¿¡å·å¤„ç†æ¨¡å—å¯ç”¨äºå…¶ä»–é¡¹ç›®
4. **ä¾¿äºæµ‹è¯•**ï¼šæ¯ä¸ªæ¨¡å—å¯ç‹¬ç«‹éªŒè¯
