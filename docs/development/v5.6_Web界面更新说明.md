# 🌐 v5.6 Web界面更新说明

> **版本**: v5.6  
> **日期**: 2025-11-28  
> **更新内容**: 更新Web界面中幅度计算方法的说明，从峰峰值法改为RMS能量法

---

## 📝 更新内容

### 1️⃣ FormulaExplanation.jsx（算法说明组件）

#### 测量原理部分
```jsx
// 更新前
采集待测电路输入端正弦波，提取峰峰值得到K
采集待测电路输出端正弦波，提取峰峰值得到K₁，计算相位差得到θ

// 更新后
采集待测电路输入端正弦波，使用RMS能量法计算幅度K
采集待测电路输出端正弦波，使用RMS能量法计算幅度K₁，DFT法计算相位差θ
```

#### 算法实现部分
```jsx
// 更新前：1. 幅度提取 - 峰峰值法
uint16_t CalculatePeakToPeak(uint16_t *data, uint32_t count)
- 遍历512个采样点，找到最大值max和最小值min
- 峰峰值 = max - min
- 转换为电压：voltage_mv = (峰峰值 × 3300) / 4096

// 更新后：1. 幅度提取 - RMS能量法（v5.6改进）
float CalculateAmplitude_DFT(uint16_t *signal, ...)
- 去直流偏移：计算512个采样点的平均值并减去
- 计算能量：累加所有采样点的平方和 Σ(x²)
- 计算RMS：RMS = √(Σ(x²) / N)
- 转换峰值：幅度 = RMS × √2
- 转换电压：voltage_mv = (幅度 × 3300) / 4096

公式显示：A = √(Σx² / N) × √2
提示文字：✨ RMS能量法比峰峰值法更稳定，不受噪声和频谱泄漏影响
```

#### 频率响应计算部分
```jsx
// 更新前
输出幅度除以输入幅度，代码实现：H = (pp_ch2 × 10000) / pp_ch1

// 更新后
输出幅度除以输入幅度（RMS能量法），代码实现：H = amp_ch2 / amp_ch1
```

#### 底部总结部分
```jsx
// 更新前
ADC双通道同步采样 · DFT相位计算 · 自动扫频测量 · Bode图实时绘制

// 更新后
ADC双通道同步采样 · RMS能量法幅度计算 · DFT相位计算 · 自动扫频测量 · Bode图实时绘制
```

---

### 2️⃣ WaveformDisplay.jsx（波形显示组件）

#### 幅值比说明
```jsx
// 更新前
<div className="stat-label">幅值比</div>

// 更新后
<div className="stat-label">幅值比 (波形显示)</div>
<span style={{ fontSize: '10px', color: '#999', ... }}>
  📊 实际测量使用RMS能量法
</span>
```

**说明**：
- 波形统计信息中仍显示"峰峰值"，这是波形的实时统计数据
- 添加了提示说明，告知用户实际的幅度测量使用RMS能量法
- 这样既保留了波形的直观统计，又明确了测量方法

---

## 🎯 更新原因

### 为什么要更新Web界面？

1. **保持一致性**
   - 固件（Keil）已改用RMS能量法
   - Web界面说明需要同步更新

2. **准确描述**
   - 旧的说明提到"峰峰值法"
   - 新的实现使用"RMS能量法"
   - 避免误导用户

3. **教育意义**
   - 清楚展示RMS能量法的优势
   - 帮助用户理解算法原理
   - 符合老师的要求（能量法）

---

## 📊 对比总结

| 项目 | 更新前 | 更新后 |
|------|--------|--------|
| **幅度算法** | 峰峰值法 | **RMS能量法** ✅ |
| **相位算法** | DFT法 | DFT法（未变） |
| **算法说明** | 简略 | **详细+公式** ✅ |
| **优势说明** | 无 | **有（稳定性）** ✅ |
| **版本标注** | 无 | **v5.6改进** ✅ |

---

## 🚀 使用指南

### 重新启动Web应用
```bash
cd react-bode-analyzer
npm run dev
```

### 查看更新后的界面
1. 打开 http://localhost:3000
2. 向下滚动到"算法说明"部分
3. 展开"算法实现"
4. 查看更新后的RMS能量法说明

### 主要变化位置
- **测量原理**：明确标注使用RMS能量法
- **算法实现**：详细的RMS计算步骤和公式
- **频率响应计算**：更新代码实现说明
- **底部总结**：添加RMS能量法标识
- **波形显示**：添加实际测量方法提示

---

## ✅ 验证清单

- [x] FormulaExplanation.jsx - 测量原理部分已更新
- [x] FormulaExplanation.jsx - 算法实现部分已更新（含公式）
- [x] FormulaExplanation.jsx - 频率响应计算部分已更新
- [x] FormulaExplanation.jsx - 底部总结已更新
- [x] WaveformDisplay.jsx - 添加RMS能量法提示
- [x] 所有文字描述与固件实现一致
- [x] 数学公式正确显示

---

## 📸 效果展示

### 算法说明页面
**更新前**：
```
1. 幅度提取 - 峰峰值法
   - 遍历512个采样点
   - 峰峰值 = max - min
```

**更新后**：
```
1. 幅度提取 - RMS能量法（v5.6改进）
   - 去直流偏移
   - 计算能量 Σ(x²)
   - 计算RMS = √(Σ(x²) / N)
   - 转换峰值 = RMS × √2
   
   公式：A = √(Σx² / N) × √2
   ✨ RMS能量法比峰峰值法更稳定，不受噪声和频谱泄漏影响
```

---

## 🎓 技术细节

### RMS公式显示
使用React的JSX语法显示数学公式：
```jsx
<span className="math-large">A = √(Σx² / N) × √2</span>
```

效果：清晰美观的数学公式展示

### 提示文字
使用emoji和小字体：
```jsx
<p style={{ fontSize: '12px', color: '#999', ... }}>
  ✨ RMS能量法比峰峰值法更稳定，不受噪声和频谱泄漏影响
</p>
```

---

## 📚 相关文档

- **固件更新**: `v5.6_DFT能量法改进说明.md`
- **算法原理**: `v5.5_技术说明.md`
- **项目总结**: `项目总结.md`

---

**作者**: leeyoung7017  
**日期**: 2025-11-28  
**版本**: v5.6  

**✅ Web界面已完全同步固件的RMS能量法实现！**
